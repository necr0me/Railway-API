---
swagger: '2.0'
info:
  title: Railway-API
  version: v1
  description: Railway-API documentation
paths:
  "/api/v1/carriages/{carriage_id}":
    get:
      summary: Get concrete carriage. By necr0me
      tags:
      - Carriages
      parameters:
      - name: carriage_id
        in: path
        type: integer
        required: true
        description: Id of carriage that you want to see
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '200':
          description: Carriage found
          examples:
            application/json:
              carriage:
                data:
                  id: '15568'
                  type: carriage
                  attributes:
                    name: Artemis
                    capacity: 8
                    carriage_type_id: 20013
                    order_number: '16'
                    available: true
                    type: Kat Toy
                  relationships:
                    seats:
                      data: []
                included: []
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '404':
          description: Carriage not found
          examples:
            application/json:
              message: Couldn't find Carriage with 'id'=-1
  api/v1/passing_trains:
    get:
      summary: Retrieves all passing trains. By necr0me
      tags:
      - Passing trains
      produces:
      - application/json
      responses:
        '200':
          description: Passing trains found
          examples:
            application/json:
              found_trains:
                data:
                  departure_station:
                    id: ''
                    attributes:
                      name: 
                  arrival_station:
                    id: ''
                    attributes:
                      name: 
                  trains:
                  - id: 10882
                    attributes:
                      destination: 
                      departs_at: '2023-04-27T10:35:34.281Z'
                      arrives_at: '2023-04-27T10:55:34.290Z'
                      travel_time: 1200.008547
  "/api/v1/profile":
    get:
      summary: Retrieves user profile. By necr0me
      tags:
      - Profile
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '200':
          description: Profile found
          examples:
            application/json:
              profile:
                id: 1384
                name: John
                surname: Doe
                patronymic: Doehovich
                phone_number: "+375331234567"
                passport_code: KH1234567
                user_id: 26447
                created_at: '2023-04-27T10:15:34.317Z'
                updated_at: '2023-04-27T10:15:34.317Z'
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
    post:
      summary: Creates user profile. By necr0me
      tags:
      - Profile
      consumes:
      - application/json
      parameters:
      - name: params
        in: body
        schema:
          type: object
          properties:
            profile:
              type: object
              properties:
                name:
                  type: string
                surname:
                  type: string
                patronymic:
                  type: string
                phone_number:
                  type: string
                passport_code:
                  type: string
              required:
              - name
              - surname
              - patronymic
              - phone_number
              - passport_code
              example:
                name: John
                surname: Doe
                patronymic: Doehovich
                phone_number: '375331234567'
                passport_code: KH1234567
          required:
          - profile
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '201':
          description: Profile successfully created
          examples:
            application/json:
              profile:
                id: 1385
                name: John
                surname: Doe
                patronymic: Doehovich
                phone_number: "+375331234567"
                passport_code: KH1234567
                user_id: 26448
                created_at: '2023-04-27T10:15:34.335Z'
                updated_at: '2023-04-27T10:15:34.335Z'
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '422':
          description: Error occurred during profile create
          examples:
            application/json:
              message: Something went wrong
              errors:
                surname:
                - can't be blank
                - is too short (minimum is 2 characters)
                patronymic:
                - can't be blank
                - is too short (minimum is 5 characters)
                phone_number:
                - can't be blank
                - is too short (minimum is 7 characters)
                passport_code:
                - can't be blank
                - is invalid
                name:
                - is too short (minimum is 2 characters)
    put:
      summary: Updates user profile. By necr0me
      tags:
      - Profile
      consumes:
      - application/json
      parameters:
      - name: params
        in: body
        schema:
          type: object
          properties:
            profile:
              type: object
              properties:
                name:
                  type: string
                surname:
                  type: string
                patronymic:
                  type: string
                phone_number:
                  type: string
                passport_code:
                  type: string
              required:
              - name
              - surname
              - patronymic
              - phone_number
              - passport_code
              example:
                name: John
                surname: Doe
                patronymic: Doehovich
                phone_number: '375331234567'
                passport_code: KH1234567
          required:
          - profile
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '200':
          description: Profile found
          examples:
            application/json:
              profile:
                user_id: 26450
                name: New name
                surname: Doe
                patronymic: Doehovich
                phone_number: "+375331234567"
                id: 1386
                passport_code: KH1234567
                created_at: '2023-04-27T10:15:34.361Z'
                updated_at: '2023-04-27T10:15:34.365Z'
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '422':
          description: Error occurred during profile update
          examples:
            application/json:
              message: Something went wrong
              errors:
                name:
                - is too short (minimum is 2 characters)
  "/api/v1/stations":
    get:
      summary: Gets all stations. By necr0me
      tags:
      - Stations
      produces:
      - application/json
      parameters:
      - name: station
        in: query
        type: string
        required: false
        description: Name of station or first N letters of station name
      responses:
        '200':
          description: Stations found (From query "?station=Mo")
          examples:
            application/json:
              stations:
              - id: 27239
                name: Mogilev
                created_at: '2023-04-27T10:15:34.385Z'
                updated_at: '2023-04-27T10:15:34.385Z'
              - id: 27240
                name: Mosty
                created_at: '2023-04-27T10:15:34.387Z'
                updated_at: '2023-04-27T10:15:34.387Z'
              pages: 1
  "/api/v1/stations/{station_id}":
    get:
      summary: Get concrete station. By necr0me
      tags:
      - Stations
      produces:
      - application/json
      parameters:
      - name: station_id
        in: path
        type: string
        required: true
        description: Id of station
      responses:
        '200':
          description: Station was found
          examples:
            application/json:
              id: 27242
              name: Melbourne
              created_at: '2023-04-27T10:15:34.401Z'
              updated_at: '2023-04-27T10:15:34.401Z'
        '404':
          description: Station not found
          examples:
            application/json:
              message: Couldn't find Station with 'id'=-1
  "/api/v1/tickets":
    post:
      summary: Creates new ticket. By necr0me
      tags:
      - Tickets
      consumes:
      - application/json
      parameters:
      - name: params
        in: body
        schema:
          type: object
          properties:
            ticket:
              type: object
              properties:
                user_id:
                  type: integer
                seat_id:
                  type: integer
                departure_station_id:
                  type: integer
                arrival_station_id:
                  type: integer
                price:
                  type: number
                  format: float
              required:
              - user_id
              - seat_id
              - departure_station_id
              - arrival_station_id
              - price
              example:
                user_id: 1
                seat_id: 1
                departure_station_id: 1
                arrival_station_id: 2
                price: 10.0
            required:
            - ticket
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '201':
          description: Ticket successfully created
          examples:
            application/json:
              message: Ticket successfully created
              ticket:
                id: 2492
                price: 10.0
                user_id: 26452
                seat_id: 51282
                arrival_station_id: 27244
                departure_station_id: 27243
                created_at: '2023-04-27T10:15:34.431Z'
                updated_at: '2023-04-27T10:15:34.431Z'
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '422':
          description: Error occurred during ticket create
          examples:
            application/json:
              message: Something went wrong
              errors:
              - Price can't be blank
              - Price is not a number
  "/api/v1/tickets/{ticket_id}":
    get:
      summary: Gets concrete ticket. By necr0me
      tags:
      - Tickets
      security:
      - Bearer: {}
      parameters:
      - name: ticket_id
        in: path
        type: integer
        required: true
        description: Id of ticket that you want to find
      produces:
      - application/json
      responses:
        '200':
          description: Ticket was found
          examples:
            application/json:
              ticket:
                id: 2493
                price: 1.5
                user_id: 26455
                seat_id: 51285
                arrival_station_id: 27249
                departure_station_id: 27249
                created_at: '2023-04-27T10:15:34.486Z'
                updated_at: '2023-04-27T10:15:34.486Z'
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '403':
          description: You are forbidden to perform this action
          examples:
            application/json:
              message: You are not allowed to do this action
        '404':
          description: Ticket not found
          examples:
            application/json:
              message: Couldn't find Ticket with 'id'=-1
    delete:
      summary: Deletes concrete ticket. By necr0me
      tags:
      - Tickets
      security:
      - Bearer: {}
      parameters:
      - name: ticket_id
        in: path
        type: integer
        required: true
        description: Id of ticket that you want to destroy
      produces:
      - application/json
      responses:
        '200':
          description: Ticket successfully destroyed
          examples:
            application/json:
              message: Ticket successfully destroyed
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '403':
          description: You are forbidden to perform this action
          examples:
            application/json:
              message: You are not allowed to do this action
        '404':
          description: Ticket not found
          examples:
            application/json:
              message: Couldn't find Ticket with 'id'=-1
        '422':
          description: Error occurred during ticket destroy
          examples:
            application/json:
              message: Something went wrong
              errors:
              - Error message
  "/api/v1/trains/{train_id}":
    get:
      summary: Show concrete train. By necr0me
      tags:
      - Trains
      parameters:
      - name: train_id
        in: path
        type: integer
        required: true
        description: Id of train that you want to see
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '200':
          description: Train found
          examples:
            application/json:
              train:
                data:
                  id: '10883'
                  type: train
                  attributes:
                    destination: No destination
                  relationships:
                    carriages:
                      data:
                      - id: '15580'
                        type: carriage
                      - id: '15581'
                        type: carriage
                      - id: '15582'
                        type: carriage
                    stops:
                      data: []
                    route:
                      data: 
                included:
                - id: '15580'
                  type: carriage
                  attributes:
                    name: Hestia
                    capacity: 8
                    carriage_type_id: 20025
                    order_number: '01'
                    available: false
                    type: Chi Spurger
                  relationships:
                    seats:
                      data:
                      - id: '51292'
                        type: seat
                      - id: '51293'
                        type: seat
                      - id: '51294'
                        type: seat
                      - id: '51295'
                        type: seat
                      - id: '51296'
                        type: seat
                      - id: '51297'
                        type: seat
                      - id: '51298'
                        type: seat
                      - id: '51299'
                        type: seat
                - id: '15581'
                  type: carriage
                  attributes:
                    name: Apollo
                    capacity: 8
                    carriage_type_id: 20026
                    order_number: '02'
                    available: false
                    type: Louise E. Anna
                  relationships:
                    seats:
                      data:
                      - id: '51300'
                        type: seat
                      - id: '51301'
                        type: seat
                      - id: '51302'
                        type: seat
                      - id: '51303'
                        type: seat
                      - id: '51304'
                        type: seat
                      - id: '51305'
                        type: seat
                      - id: '51306'
                        type: seat
                      - id: '51307'
                        type: seat
                - id: '15582'
                  type: carriage
                  attributes:
                    name: Ares
                    capacity: 8
                    carriage_type_id: 20027
                    order_number: '03'
                    available: false
                    type: Ginger Rayl
                  relationships:
                    seats:
                      data:
                      - id: '51308'
                        type: seat
                      - id: '51309'
                        type: seat
                      - id: '51310'
                        type: seat
                      - id: '51311'
                        type: seat
                      - id: '51312'
                        type: seat
                      - id: '51313'
                        type: seat
                      - id: '51314'
                        type: seat
                      - id: '51315'
                        type: seat
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '403':
          description: You are forbidden to perform this action
          examples:
            application/json:
              message: You are not allowed to do this action
        '404':
          description: Train not found
          examples:
            application/json:
              message: Couldn't find Train with 'id'=-1
  "/api/v1/users/{user_id}":
    get:
      summary: Retrieves concrete user. By necr0me
      tags:
      - Users
      parameters:
      - name: user_id
        in: path
        type: integer
        required: true
        description: Id of user that you want to see
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '200':
          description: User found
          examples:
            application/json:
              user:
                id: 26469
                email: johndoe@gmail.com
                password_digest: "$2a$04$zS9nh1UlJ4.hE3txwqKtpuIjNUPQ.6eXLaqGJSt2DuSU.1GgZvvAm"
                created_at: '2023-04-27T10:15:34.873Z'
                updated_at: '2023-04-27T10:15:34.873Z'
                role: admin
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '403':
          description: You are forbidden to perform this action
          examples:
            application/json:
              message: You are not allowed to do this action
    put:
      summary: Updates user password. By necr0me
      tags:
      - Users
      consumes:
      - application/json
      parameters:
      - name: user_id
        in: path
        type: integer
        required: true
        description: Id of user that updates password (ANY user can update only his
          own password)
      - name: params
        in: body
        schema:
          type: object
          properties:
            user:
              type: object
              properties:
                password:
                  type: string
              required:
              - password
              example:
                password: p4$$w0rD
          required:
          - user
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '200':
          description: User found
          examples:
            application/json:
              message: You have successfully updated your credentials
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '403':
          description: You are forbidden to perform this action
          examples:
            application/json:
              message: You are not allowed to do this action
        '422':
          description: Error occurred during update
          examples:
            application/json:
              message: Something went wrong
              errors:
              - Password can't be blank
              - Password is too short (minimum is 7 characters)
  "/users/sign_up":
    post:
      summary: Register new user. By necr0me
      tags:
      - Registrations
      consumes:
      - application/json
      parameters:
      - name: params
        in: body
        schema:
          type: object
          properties:
            user:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
              - email
              - password
              example:
                email: mail@gmail.com
                password: p4$$w0rD
          required:
          - user
      produces:
      - application/json
      responses:
        '201':
          description: User successfully created
          examples:
            application/json:
              message: You have successfully registered
        '422':
          description: Error occurred during user registration
          examples:
            application/json:
              errors:
                email:
                - can't be blank
                - is invalid
                password:
                - can't be blank
                - is too short (minimum is 7 characters)
                - can't be blank
  "/users/{user_id}":
    delete:
      summary: Destroy user. By necr0me
      tags:
      - Registrations
      parameters:
      - name: user_id
        in: path
        type: integer
        required: true
        description: Id of user that destroys account (user can destroy only own account
          unless role is admin)
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '204':
          description: User successfully destroyed
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
        '403':
          description: You are forbidden to perform this action
          examples:
            application/json:
              message: You are not allowed to do this action
        '404':
          description: User not found
          examples:
            application/json:
              message: Couldn't find User with 'id'=-1
        '422':
          description: Error occurred during user destroy
          examples:
            application/json:
              message: Something went wrong
              errors:
              - Error message
  "/users/login":
    post:
      summary: Authenticates user. By necr0me
      tags:
      - Authentication
      consumes:
      - application/json
      parameters:
      - name: params
        in: body
        schema:
          type: object
          properties:
            user:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
              - email
              - password
              example:
                email: mail@gmail.com
                password: p4$$w0rD
          required:
          - user
      produces:
      - application/json
      responses:
        '201':
          description: Authenticated successfully
          examples:
            application/json:
              message: You have successfully logged in
              access_token: eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoyNjQ4NSwiZXhwIjoxNjgyNTkyMzM1LCJpYXQiOjE2ODI1OTA1MzV9.vnRoOwujmqrMH2ln5eC5BBQj14NmmwD1mbQIaU1NXCw
        '400':
          description: Error occurred during authentication
          examples:
            application/json:
              message: Something went wrong
              errors:
                email:
                - Can't find user with such email
  "/users/refresh_tokens":
    get:
      summary: Refreshes access and refresh tokens. By necr0me
      tags:
      - Authentication
      produces:
      - application/json
      responses:
        '200':
          description: Tokens successfully updated
          examples:
            application/json:
              access_token: eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoyNjQ4NywiZXhwIjoxNjgyNTkyMzM1LCJpYXQiOjE2ODI1OTA1MzV9.uZfL4Gx7w6BYY67WddT54hLH2jJhAqwUyoi0wQituH8
        '401':
          description: Error occurred during tokens update
          examples:
            application/json:
              errors:
              - Nil JSON web token
  "/users/logout":
    delete:
      summary: Logouts user. By necr0me
      tags:
      - Authentication
      parameters:
      - name: Authorization
        in: header
        type: string
        required: true
        description: 'Authorization header of user that logout. Header looks like
          this: ''Bearer <access-token>'''
      produces:
      - application/json
      security:
      - Bearer: {}
      responses:
        '200':
          description: Successful logout
          examples:
            application/json:
              message: You have successfully logged out.
        '401':
          description: You are unauthorized
          examples:
            application/json:
              message: You're not logged in
              errors:
              - Nil JSON web token
securityDefinitions:
  Bearer:
    description: Authorization header (JWT-token)
    type: apiKey
    name: Authorization
    in: header
servers:
- url: http://{defaultHost}/
  variables:
    defaultHost:
      default: localhost:3000
